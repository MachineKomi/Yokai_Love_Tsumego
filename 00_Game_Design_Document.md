Here is the **Game Design Document (GDD)**. This serves as the "Constitution" for the project. It translates the high-level pitch into actionable mechanics, loops, and systems that our AI Agents can implement.

It is designed to be **modular** (so we can cut features if scope creeps) and **technically grounded** in the Architecture we agreed upon (Supabase + React + KataGo).

***

# 00_Game_Design_Document.md

# Tsumego Tower: The Divine Ascent
**Project Code:** `tsumego-tower`
**Version:** 1.0.0
**Status:** In Development

---

## 1. Executive Summary

**Tsumego Tower** is a hybrid **Go Teaching Tool** and **Roguelike Dating Sim**. Players ascend an infinite tower by solving Go puzzles (Tsumego), engaging in "combat" against AI-generated board positions. As they climb, they rescue and recruit "Yokai Waifus" and "Divine Goddesses" (personifications of famous Go AIs), unlocking visual novel story arcs, outfits, and aesthetic customizations.

**The Hook:** "Get stronger at Go to get closer to your Waifus."
**Target Audience:** Go players (25k to 9d), fans of logic puzzles, and fans of anime/VN aesthetics.
**Platform:** Web (PWA), Steam (PC/Mac/Linux via Tauri), Mobile (iOS/Android wrapper).

---

## 2. Core Gameplay Loop

The game relies on a tight "Compulsion Loop" combining intellectual satisfaction with visual/narrative rewards.

1.  **The Climb (Action):** The player selects a floor and solves a series of Tsumego puzzles. Success maintains a "Streak."
2.  **The Reward (Loot):** Solving puzzles earns **Spirit Stones** (Currency) and **Affection Points** (with the active companion).
3.  **The Respite (VN/Dating):** Between climbs, players visit their "Home Base" to interact with unlocked companions, view cutscenes, buy gifts, or customize their avatar/board.
4.  **The Upgrade (Progression):** Spirit Stones are spent to unlock new Board Skins, Stone Effects, or "Teaching Tools" (Visual Aids).

---

## 3. Game Mechanics: The Tower (Puzzle Gameplay)

### 3.1. The Combat System (Tsumego)
Instead of swords or magic, "Combat" is placing the correct stone on a Go board.
* **Input:** Point-and-click (Mouse) or Tap (Touch).
* **The Enemy:** An AI-generated board state (generated by our Python/KataGo pipeline).
* **Win Condition:** Find the *only* move that kills the enemy group or saves the player's group (Standard Life & Death).
* **Fail State:** Playing a suboptimal move. The system immediately refutes the move (plays the punishment) and marks the puzzle as "Failed."

### 3.2. Difficulty Scaling & The "Elo" System
* **Floors 1-10:** Beginner (25k - 20k). One-move kill/save.
* **Floors 11-50:** Intermediate (19k - 10k). Simple sequences (3-5 moves).
* **Floors 51-100:** Advanced (9k - 1d). Complex shapes, under-the-stones, snapbacks.
* **The Infinite Spire (100+):** Dan level (1d - 9d+). Pro-level blunders and deep reading problems.
* *Note:* Difficulty is dynamically adjusted. If a player fails 3 times on a floor, they are offered a "Demotion" or a "Hint."

### 3.3. The Streak System
To encourage flow state, players are rewarded for chaining correct answers without hints.
* **Multipliers:** 2x, 4x, 8x, 16x... up to 64x Spirit Stone gain.
* **Break:** Failing a puzzle resets the streak to 0.

### 3.4. Teaching Mode & "God's Eye"
Players can enter "Analysis Mode" after solving (or failing) a puzzle.
* **Engine:** Powered by client-side KataGo (WASM).
* **Emotional Aura (Visualizer):** A toggleable overlay.
    * **Blue/Calm Aura:** Safe territory (100% owner).
    * **Red/Jagged Aura:** Contested/Weak groups.
    * **Purple Haze:** Dead stones.
* **Variation Tree:** Players can play out "What if?" scenarios. The AI responds to their moves to show *why* a variation doesn't work.

---

## 4. Game Mechanics: The Harem (VN/Dating)

### 4.1. Companions (Waifus)
Characters are unlocked by defeating "Boss Floors" (every 10 floors).
* **Yokai:** Standard companions (e.g., Kitsune, Oni, Yuki-onna). Represent different playstyles (Aggressive, Defensive).
* **Goddesses:** Rare companions (e.g., "Alpha-chan", "KataGo-sama"). Represent pure logic and perfection.

### 4.2. Interaction
* **Home Screen:** The active companion stands in the lobby (Live2D/Animated Sprite).
* **Dialogue:** Clicking them triggers random voice lines/text based on Affection Level.
* **Gifting:** Spend Spirit Stones to give gifts. Correct gifts boost Affection.
* **Romance Events:** Reaching Affection Milestones (Lv 5, 10, 50) unlocks specific Story Scenes (VN style) and CG Artworks.

### 4.3. Customization
Players can customize the "Cosplay" of their companions (outfits unlocked via gameplay or premium currency).

---

## 5. Economy & Monetization

We utilize a "Fair F2P" model inspired by *Azur Lane* or *Genshin Impact*â€”generous with gameplay, monetized on cosmetics and time-savers.

### 5.1. Currencies
1.  **Spirit Stones (Soft Currency):**
    * *Source:* Gameplay, Daily Quests, Streaks.
    * *Sink:* Gifts, Basic Board Skins, Basic Outfits.
2.  **Karma (Hard Currency):**
    * *Source:* Real Money, Monthly Subscription, Rare Achievements.
    * *Sink:* Premium Waifu Outfits, Exotic Board Skins (e.g., Neon, Cyberpunk), "Oath Rings."

### 5.2. Energy System (The "Stamina")
* **Free Players:** 10 "Mental Energy" per day. 1 Puzzle = 1 Energy. Replenishes over time.
* **Subscription (Ascended Pass):** Cap increased to 64 Energy. Faster replenishment.
* *Rationale:* Prevents server spam and incentivizes the subscription for power users.

### 5.3. The "Ascended" Subscription ($5/mo)
* Unlock 64 Puzzles/Day cap.
* Access to "God's Eye" (Emotional Aura) during the puzzle (as a hint), not just post-game.
* Monthly unique outfit.

---

## 6. Technical & AI Implementation Strategy

### 6.1. The AI Factory (Backend)
* **Role:** Offline generation of content.
* **Process:** Python script + KataGo scans SGF libraries -> Detects blunders -> Crops local position -> Validates "Unique Solution" -> Uploads to Supabase.
* **Volume:** We aim for 100,000+ stored puzzles at launch.

### 6.2. The AI Client (Frontend)
* **Role:** Real-time feedback.
* **Process:** `katago-js` (WASM) runs in a Web Worker. It calculates the "Score Lead" and "Ownership Grid" for the visualization effects.

### 6.3. AI Art Assets
* **Backgrounds:** Stable Diffusion (Anime Scenery, Fantasy Towers).
* **Sprites:** Midjourney/Niji (Character Design) -> Manual cleanup/cutting -> Live2D/Spine animation.
* **CGs:** High-fidelity AI generation + manual paint-over for "Ecchi" elements to ensure quality and consistency.

---

## 7. User Interface (UI) Structure

1.  **Splash Screen:** Title, "Touch to Start."
2.  **Main Lobby (Home):**
    * Background: The Player's Room (Customizable).
    * Foreground: Active Waifu.
    * Buttons: "Climb Tower", "Companions", "Shop", "Settings", "Study".
3.  **Tower Map:** Vertical scrolling map showing floors and boss nodes.
4.  **Game Board:**
    * Center: 19x19 (or cropped) Go Board.
    * Top: Progress bar, Streak Counter.
    * Bottom: "Place Stone" (Mobile friendly), "Pass", "Hint".
5.  **VN Scene:** Standard dialogue box (bottom), Character Sprite (center), Background.

---

## 8. Development Phases (Vertical Slice Focus)

**Phase 1: The Skeleton (Current)**
* Local Supabase Setup.
* Basic React+Pixi Board.
* Ability to load 1 static puzzle and play stones.

**Phase 2: The Loop**
* Win/Loss logic.
* Simple "Streak" counter.
* Unlocking 1 static Image Reward upon clearing Floor 1.

**Phase 3: The Polish**
* KataGo WASM integration for analysis.
* Full Waifu UI and Affection system.
* Steam Integration.

---

## 9. Tone & Safety Guidelines
* **ESRB Rating Target:** "T for Teen" or "M for Mature" (depending on platform).
* **Steam:** "Ecchi" is allowed, but no explicit genitalia/hardcore content. We focus on "Romance," "Suggestive Themes," and "Fan Service."
* **Vibe:** Wholesome but spicy. The Waifus genuinely want to help you get better at Go.